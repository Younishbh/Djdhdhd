<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ù…ØªØ¬Ø± Ø§Ù„Ø¹Ø·ÙˆØ± â€” Ø­Ø¬Ø² Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</title>
  <style>
    :root{
      --bg:#0b0b0c; --card:#0f0f10; --accent:#c39b32; --accent-2:#b8860b; --muted:#cfc8be;
      --glass: rgba(255,255,255,0.03);
      --shadow: 0 12px 40px rgba(0,0,0,0.6);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Naskh Arabic", "Helvetica Neue", Arial; background:var(--bg); color:var(--muted); line-height:1.45}
    header{display:flex;align-items:center;justify-content:space-between;padding:14px 20px;background:linear-gradient(180deg,#0f0f10,#0b0b0c);box-shadow:0 4px 30px rgba(0,0,0,0.6);position:sticky;top:0;z-index:40}
    .brand{display:flex;gap:12px;align-items:center}
    .logo{width:52px;height:52px;border-radius:12px;background:linear-gradient(135deg,#2b2b2b,#0f0f10);display:flex;align-items:center;justify-content:center;font-weight:800;color:var(--accent);font-size:20px;border:1px solid rgba(195,155,50,0.12)}
    h1{margin:0;font-size:18px;color:var(--muted)}
    .muted{font-size:12px;color:#bfb6a8}
    nav{display:flex;gap:8px;align-items:center}
    nav a{color:var(--muted);text-decoration:none;padding:8px 12px;border-radius:10px;font-weight:700}
    nav a:hover{background:rgba(195,155,50,0.06);color:var(--accent)}
    .controls{display:flex;gap:10px;align-items:center}
    .search{padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);min-width:180px;background:transparent;color:var(--muted)}
    .btn{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#0b0b0c;border:0;padding:10px 14px;border-radius:10px;cursor:pointer;font-weight:700;box-shadow:var(--shadow)}
    .btn.ghost{background:transparent;color:var(--muted);border:1px solid rgba(255,255,255,0.03)}
    main{max-width:1100px;margin:24px auto;padding:0 16px 80px}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:18px}
    .card{background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border-radius:16px;padding:12px;box-shadow:var(--shadow);display:flex;flex-direction:column;gap:10px;cursor:pointer;transition:transform .18s,box-shadow .18s;border:1px solid rgba(255,255,255,0.02)}
    .card:hover{transform:translateY(-6px);box-shadow:0 22px 60px rgba(0,0,0,0.7)}
    .imgwrap{height:210px;border-radius:12px;overflow:hidden;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,#0d0d0d,#151515)}
    .imgwrap img{width:100%;height:100%;object-fit:cover;filter:contrast(1.02) saturate(1.05)}
    .meta{text-align:center;padding:6px}
    .title{font-weight:800;font-size:16px;margin-bottom:6px;color:var(--muted)}
    .price{font-weight:900;color:var(--accent);font-size:16px}
    .old{text-decoration:line-through;color:#8b8b8b;font-size:13px}
    #detailPage,#checkoutPage{display:none;animation:fade .25s}
    @keyframes fade{from{opacity:0}to{opacity:1}}
    #detailPage img{width:100%;max-width:480px;border-radius:14px;box-shadow:0 8px 28px rgba(0,0,0,0.6)}
    .detail-info{margin-top:14px}
    #cartPanel{position:fixed;top:0;bottom:0;right:0;width:380px;max-width:96%;background:linear-gradient(180deg,#0f0f10,#0b0b0c);box-shadow:-14px 0 48px rgba(0,0,0,0.6);transform:translateX(110%);transition:transform .28s ease;z-index:80;display:flex;flex-direction:column;border-left:1px solid rgba(255,255,255,0.02)}
    #cartPanel.open{transform:translateX(0)}
    #cartHeader{padding:16px;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid rgba(255,255,255,0.02)}
    #cartBody{padding:14px;overflow:auto;flex:1}
    .cart-item{display:flex;gap:12px;align-items:center;padding:10px 0;border-bottom:1px solid rgba(255,255,255,0.02)}
    .cart-item img{width:64px;height:64px;border-radius:8px;object-fit:cover}
    .cart-foot{padding:16px;border-top:1px solid rgba(255,255,255,0.02)}
    footer{padding:18px;text-align:center;color:var(--muted);position:relative;z-index:0}
    .whatsapp{position:fixed;left:16px;bottom:16px;width:62px;height:62px;border-radius:50%;background:linear-gradient(90deg,#25D366,#22b56b);display:flex;align-items:center;justify-content:center;box-shadow:0 14px 40px rgba(0,0,0,0.6);z-index:90}
    input,textarea,select{width:100%;padding:10px;margin-top:6px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);font-size:15px;background:transparent;color:var(--muted)}
    form{max-width:620px;margin:14px auto;background:linear-gradient(180deg,#0f0f10,#0b0b0c);padding:18px;border-radius:14px;box-shadow:0 8px 28px rgba(0,0,0,0.6);border:1px solid rgba(255,255,255,0.02)}
    .tag{display:inline-block;background:rgba(195,155,50,0.12);color:var(--accent);padding:6px 10px;border-radius:999px;font-weight:700}
    @media(max-width:880px){ .imgwrap{height:160px} #cartPanel{width:320px} .logo{width:44px;height:44px} }
    @media(max-width:520px){ header{flex-direction:column;align-items:stretch;gap:10px} nav{order:3} main{padding:12px} form{padding:12px} }
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <div class="logo">Ø¹</div>
      <div>
        <h1>Ù…ØªØ¬Ø± Ø§Ù„Ø¹Ø·ÙˆØ±</h1>
        <div class="muted">Ø®Ù„Ø·Ø§ØªÙ†Ø§ Ø§Ù„Ø®Ø§ØµØ© â€” ÙØ®Ø§Ù…Ø© ÙˆØ£Ù…Ø§Ù†</div>
      </div>
    </div>

    <nav>
      <a href="#" id="link-home">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
      <a href="#" id="link-offers">Ø¹Ø±ÙˆØ¶Ù†Ø§</a>
    </nav>

    <div class="controls">
      <input id="search" class="search" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø¹Ø·Ø±..." aria-label="Ø¨Ø­Ø«">
      <button id="openCartBtn" class="btn" title="Ø¹Ø±Ø¶ Ø§Ù„Ø³Ù„Ø©">Ø§Ù„Ø³Ù„Ø© (<span id="cartCount">0</span>)</button>
    </div>
  </header>

  <main>
    <!-- Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
    <section id="homePage"><div id="grid" class="grid" aria-live="polite"></div></section>

    <!-- ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬ -->
    <section id="detailPage" style="padding:18px;">
      <button class="btn ghost" id="backBtn">â† Ø±Ø¬ÙˆØ¹</button>
      <div style="display:flex;flex-wrap:wrap;gap:18px;margin-top:16px;align-items:flex-start;justify-content:center">
        <img id="detailImg" alt="">
        <div class="detail-info">
          <h2 id="detailName"></h2>
          <p id="detailDesc" style="color:var(--muted)"></p>
          <p style="margin-top:8px"><strong>Ø§Ù„Ø³Ø¹Ø±:</strong> <span id="detailPrice"></span></p>
          <div style="margin-top:12px">
            <button id="addToCartDetail" class="btn">Ø£Ø¶Ù Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©</button>
          </div>
        </div>
      </div>
    </section>

    <!-- ØµÙØ­Ø© Ø§Ù„Ø­Ø¬Ø² (Ù†Ù…ÙˆØ°Ø¬) -->
    <section id="checkoutPage" style="padding:18px;">
      <button class="btn ghost" id="backToCart">â† Ø±Ø¬ÙˆØ¹</button>
      <h2 style="text-align:center;margin-top:10px;">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø­Ø¬Ø²</h2>

      <form id="orderForm" aria-label="Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø­Ø¬Ø²">
        <label>Ø§Ù„Ø§Ø³Ù…</label>
        <input id="custName" required placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„">

        <label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
        <input id="custPhone" required type="tel" placeholder="Ù…Ø«Ø§Ù„: 0785xxxxxxx">

        <label>Ø§Ù„Ø³ÙƒÙ†</label>
        <input id="custAddress" required placeholder="Ø´Ø§Ø±Ø¹/Ù…Ù†Ø·Ù‚Ø©/Ù…Ø¯ÙŠÙ†Ø©">

        <label>Ø£Ù‚Ø±Ø¨ Ù†Ù‚Ø·Ø© Ø¯Ø§Ù„Ø©</label>
        <input id="custNear" required placeholder="Ù…Ø«Ù„Ø§Ù‹: Ø£Ù…Ø§Ù… Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ù†ÙˆØ±">

        <button type="button" id="getLocation" class="btn ghost" style="margin-top:10px">ğŸ“ ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹ÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ</button>
        <div id="locStatus" style="font-size:13px;color:var(--muted);margin-top:8px;">(Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ø®ØªÙŠØ§Ø±ÙŠØ© Ù„ÙƒÙ† ØªØ³Ø§Ø¹Ø¯ ÙÙŠ Ø§Ù„ØªÙˆØµÙŠÙ„)</div>

        <div style="margin-top:14px">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div style="color:var(--muted)">Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø·Ù„Ø¨</div>
            <div id="summaryTotal" style="font-weight:900;color:var(--accent)">0 Ø¯.Ø¹</div>
          </div>
        </div>

        <button type="submit" class="btn" style="margin-top:14px">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ù„Ù„Ø­Ø¬Ø²</button>
      </form>
    </section>
  </main>

  <!-- ÙˆØ§ØªØ³Ø§Ø¨ Ø«Ø§Ø¨Øª -->
  <a id="whats" class="whatsapp" target="_blank" rel="noopener" aria-label="ÙˆØ§ØªØ³Ø§Ø¨">
    <svg width="30" height="30" viewBox="0 0 24 24" fill="#fff"><path d="M20.52 3.48A11.8 11.8 0 0012 .5C6 0.5 1.3 5.2 1.3 11.2c0 1.98.52 3.9 1.5 5.6L.5 23.5l6.9-1.8c1.6.8 3.4 1.2 5.4 1.2 6 0 10.7-4.7 10.7-10.7 0-3-1.2-5.8-3.5-7.7z"/></svg>
  </a>

  <!-- Ù„ÙˆØ­Ø© Ø§Ù„Ø³Ù„Ø© -->
  <aside id="cartPanel" aria-hidden="true">
    <div id="cartHeader">
      <h3>Ø³Ù„Ø© Ø§Ù„ØªØ³ÙˆÙ‚</h3>
      <button id="closeCart" class="btn ghost">Ø¥ØºÙ„Ø§Ù‚</button>
    </div>
    <div id="cartBody">
      <div id="emptyNotice" style="padding:20px;text-align:center;color:var(--muted)">Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©</div>
      <div id="items"></div>
    </div>
    <div class="cart-foot">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px">
        <div>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</div>
        <div id="total" style="font-weight:900;color:var(--accent)">0 Ø¯.Ø¹</div>
      </div>
      <button id="checkout" class="btn" style="width:100%">Ø´Ø±Ø§Ø¡ Ø§Ù„Ø¢Ù†</button>
    </div>
  </aside>

  <footer>Â© <span id="year"></span> Ù…ØªØ¬Ø± Ø§Ù„Ø¹Ø·ÙˆØ±</footer>

  <script>
    // ------------------- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª (Ø¹Ø¯Ù„ Ù‡Ù†Ø§ Ø¥Ø°Ø§ Ø±ØºØ¨Øª) -------------------
    // Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… ÙˆØ§ØªØ³Ø§Ø¨ ÙƒÙ…Ø§ Ù‚Ø¯Ù…ØªÙ‡Ø› Ø³Ù†Ø­ÙˆÙ‘Ù„Ù‡ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø¥Ù„Ù‰ ØµÙŠØºØ© Ø¯ÙˆÙ„ÙŠØ© Ø¥Ù† Ø¨Ø¯Ø£ Ø¨Ù€ 0
    const whatsappNumberLocal = "07858644168"; // Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø°ÙŠ Ø²ÙˆØ¯ØªÙ†ÙŠ Ø¨Ù‡
    // -----------------------------------------------------------------

    // Ø¯Ø§Ù„Ø© Ù„ØªØ­ÙˆÙŠÙ„ Ø±Ù‚Ù… Ù…Ø­Ù„ÙŠ ÙŠØ¨Ø¯Ø£ Ø¨Ù€ 0 Ø¥Ù„Ù‰ ØªÙ†Ø³ÙŠÙ‚ Ø¯ÙˆÙ„ÙŠ Ù„Ù„Ø¹Ø±Ø§Ù‚ (964...) ÙˆØ¥Ø²Ø§Ù„Ø© Ø£ÙŠ Ø­Ø±ÙˆÙ
    function toInternationalNumber(raw){
      const digits = String(raw).replace(/\D/g,'');
      if(!digits) return '';
      if(digits.startsWith('0')) return '964' + digits.slice(1); // 0xxx -> 964xxx
      // Ø¥Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ¶Ø¹ Ø±Ù‚Ù… Ø¯ÙˆÙ„ÙŠ (Ù…Ø«Ù„Ø§Ù‹ 964...)ØŒ Ù†Ø¹ÙŠØ¯Ù‡ ÙƒÙ…Ø§ Ù‡Ùˆ
      return digits;
    }
    const whatsappNumber = toInternationalNumber(whatsappNumberLocal);

    // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª (Ù…Ø¶Ù…Ù†Ø©)
    const products = [
      {id:"1", name:"Ø¨ØºØ¯Ø§Ø¯", price:7000, image:"https://images.unsplash.com/photo-1600180758890-6d8301a35b9f?w=900&q=80"},
      {id:"2", name:"Ø±Ù‚Ø©", price:7000, image:"https://images.unsplash.com/photo-1585386959984-a4155224a1e1?w=900&q=80"},
      {id:"3", name:"Ù‡Ø¯ÙˆØ¡", price:8000, image:"https://images.unsplash.com/photo-1611162616305-4ec3060a058e?w=900&q=80"},
      {id:"4", name:"Ø¹Ø±Ø¶ Ø®Ø§Øµ (Ø¨ØºØ¯Ø§Ø¯ + Ø±Ù‚Ø© + Ù‡Ø¯ÙˆØ¡)", price:15000, oldPrice:22000, offer:true, image:"https://images.unsplash.com/photo-1600180758890-6d8301a35b9f?w=900&q=80"}
    ];

    const productDesc = "Ø§Ù„Ø¹Ø·Ø± Ù…ØµÙ†ÙˆØ¹ Ù…Ù† Ø®Ù„Ø·Ø© Ø®Ø§ØµØ© Ø¨Ù†Ø§ ÙÙ‚Ø· ÙˆÙ„Ø§ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø²ÙŠÙˆØª Ù…Ø¶Ø±Ø© Ø£Ùˆ Ù…Ø³Ø¨Ø¨Ø© Ù„Ù„Ø­Ø³Ø§Ø³ÙŠØ©. ØªÙ… Ø§Ù„ØµÙ†Ø¹ Ø¨Ø·Ø±ÙŠÙ‚Ø© Ø§Ø¨ØªÙƒØ§Ø±ÙŠØ© Ø­Ø¯ÙŠØ«Ø© ØªÙ…Ù†Ø­Ùƒ Ø«Ø¨Ø§ØªÙ‹Ø§ ÙˆØ£Ù†Ø§Ù‚Ø© ØªØ¯ÙˆÙ….";

    // Ø¹Ù†Ø§ØµØ± DOM
    const grid = document.getElementById('grid');
    const search = document.getElementById('search');
    const homePage = document.getElementById('homePage');
    const detailPage = document.getElementById('detailPage');
    const checkoutPage = document.getElementById('checkoutPage');
    const cartPanel = document.getElementById('cartPanel');
    const itemsEl = document.getElementById('items');
    const totalEl = document.getElementById('total');
    const cartCountEl = document.getElementById('cartCount');
    const summaryTotal = document.getElementById('summaryTotal');
    const locStatus = document.getElementById('locStatus');
    const whatsAnchor = document.getElementById('whats');
    let cart = JSON.parse(localStorage.getItem('cart') || '[]');
    let currentProduct = null;
    let locationLink = ''; // Ø±Ø§Ø¨Ø· Google Maps Ø¥Ù† ØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹
    const nf = new Intl.NumberFormat('ar-EG');

    // ØªÙ‡ÙŠØ¦Ø© Ø±Ø§Ø¨Ø· ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ø¸Ø§Ù‡Ø± ÙÙŠ Ø§Ù„ØµÙØ­Ø© (Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø«Ø§Ø¨ØªØ©)
    if(whatsappNumber) {
      whatsAnchor.href = `https://wa.me/${whatsappNumber}`;
    } else {
      // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø±Ø§Ø¨Ø· Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ø§Ù„Ø±Ù‚Ù… ØµØ§Ù„Ø­Ù‹Ø§
      whatsAnchor.style.display = 'none';
      console.warn('Ø±Ù‚Ù… ÙˆØ§ØªØ³Ø§Ø¨ ØºÙŠØ± ØµØ§Ù„Ø­ Ø£Ùˆ Ù„Ù… ÙŠÙØ¯Ø®Ù„ Ø¨Ø´ÙƒÙ„ Ø±Ù‚Ù…ÙŠ.');
    }

    // Ø±Ù†Ø¯Ø± Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
    function renderProducts(list){
      grid.innerHTML = '';
      if(!list.length){
        grid.innerHTML = "<div style='grid-column:1/-1;text-align:center;padding:28px;color:var(--muted)'>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª</div>";
        return;
      }
      list.forEach(p => {
        const el = document.createElement('article');
        el.className = 'card';
        el.innerHTML = `
          <div class="imgwrap"><img src="${p.image}" alt="${escapeHtml(p.name)}"></div>
          <div class="meta">
            <div class="title">${escapeHtml(p.name)}</div>
            ${p.oldPrice ? `<div class="old">${nf.format(p.oldPrice)} Ø¯.Ø¹</div>` : ''}
            <div class="price">${nf.format(p.price)} Ø¯.Ø¹</div>
          </div>
        `;
        el.onclick = () => showDetail(p);
        grid.appendChild(el);
      });
    }

    // ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬
    function showDetail(p){
      currentProduct = p;
      homePage.style.display = 'none';
      checkoutPage.style.display = 'none';
      detailPage.style.display = 'block';
      document.getElementById('detailName').textContent = p.name;
      document.getElementById('detailDesc').textContent = productDesc;
      document.getElementById('detailPrice').textContent = nf.format(p.price) + ' Ø¯.Ø¹';
      document.getElementById('detailImg').src = p.image;
      window.scrollTo({top:0,behavior:'smooth'});
    }

    document.getElementById('backBtn').onclick = () => {
      detailPage.style.display = 'none';
      homePage.style.display = 'block';
    };

    document.getElementById('addToCartDetail').onclick = () => {
      if(!currentProduct) return;
      addToCartById(currentProduct.id);
      alert('ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©');
    };

    // Ø³Ù„Ø©
    function addToCartById(id){
      const p = products.find(x => x.id === id);
      if(!p) return;
      const found = cart.find(i => i.id === id);
      if(found) found.qty += 1;
      else cart.push({...p, qty:1});
      saveCart();
    }

    function saveCart(){
      localStorage.setItem('cart', JSON.stringify(cart));
      renderCart();
    }

    function renderCart(){
      itemsEl.innerHTML = '';
      if(cart.length === 0){
        document.getElementById('emptyNotice').style.display = 'block';
        totalEl.textContent = '0 Ø¯.Ø¹';
        cartCountEl.textContent = '0';
        summaryTotal.textContent = '0 Ø¯.Ø¹';
        return;
      }
      document.getElementById('emptyNotice').style.display = 'none';
      let total = 0;
      cart.forEach(item => {
        total += item.price * item.qty;
        const row = document.createElement('div');
        row.className = 'cart-item';
        row.innerHTML = `
          <img src="${item.image}" alt="">
          <div style="flex:1">
            <div style="font-weight:800">${escapeHtml(item.name)}</div>
            <div style="color:var(--muted);margin-top:6px">${nf.format(item.price)} Ø¯.Ø¹</div>
            <div style="margin-top:8px;display:flex;gap:8px;align-items:center">
              <input class="qty" type="number" min="1" value="${item.qty}" data-id="${item.id}" style="width:70px">
              <button class="btn ghost remove" data-id="${item.id}">Ø­Ø°Ù</button>
            </div>
          </div>
        `;
        itemsEl.appendChild(row);
      });
      totalEl.textContent = nf.format(total) + ' Ø¯.Ø¹';
      cartCountEl.textContent = cart.reduce((s,i) => s + i.qty, 0);
      summaryTotal.textContent = nf.format(total) + ' Ø¯.Ø¹';

      // Ø±Ø¨Ø· Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø­Ø°Ù ÙˆØ§Ù„ÙƒÙ…ÙŠØ©
      itemsEl.querySelectorAll('.remove').forEach(btn => {
        btn.onclick = () => {
          cart = cart.filter(x => x.id !== btn.dataset.id);
          saveCart();
        };
      });
      itemsEl.querySelectorAll('.qty').forEach(inp => {
        inp.onchange = () => {
          const id = inp.dataset.id;
          const v = Math.max(1, parseInt(inp.value) || 1);
          cart = cart.map(x => x.id === id ? {...x, qty: v} : x);
          saveCart();
        };
      });
    }

    // Ø¨Ø­Ø«
    search.addEventListener('input', () => {
      const q = (search.value || '').trim();
      if(!q) renderProducts(products);
      else {
        const filtered = products.filter(p => (p.name || '').toLowerCase().includes(q.toLowerCase()));
        renderProducts(filtered);
      }
    });

    // Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙ†Ù‚Ù„
    document.getElementById('link-home').onclick = (e) => {
      e.preventDefault();
      renderProducts(products);
      homePage.style.display = 'block';
      detailPage.style.display = 'none';
      checkoutPage.style.display = 'none';
      window.scrollTo({top:0,behavior:'smooth'});
    };
    document.getElementById('link-offers').onclick = (e) => {
      e.preventDefault();
      renderProducts(products.filter(p => p.offer));
      homePage.style.display = 'block';
      detailPage.style.display = 'none';
      checkoutPage.style.display = 'none';
      window.scrollTo({top:0,behavior:'smooth'});
    };

    // Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø³Ù„Ø©
    document.getElementById('openCartBtn').onclick = () => cartPanel.classList.add('open');
    document.getElementById('closeCart').onclick = () => cartPanel.classList.remove('open');

    // Ø§Ù„Ø´Ø±Ø§Ø¡ -> ÙŠÙØªØ­ ØµÙØ­Ø© Ø§Ù„Ø­Ø¬Ø² (Ø§Ù„Ù†Ù…ÙˆØ°Ø¬)
    document.getElementById('checkout').onclick = () => {
      if(cart.length === 0) return alert('Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©');
      cartPanel.classList.remove('open');
      homePage.style.display = 'none';
      detailPage.style.display = 'none';
      checkoutPage.style.display = 'block';
      window.scrollTo({top:0,behavior:'smooth'});
    };

    document.getElementById('backToCart').onclick = () => {
      checkoutPage.style.display = 'none';
      homePage.style.display = 'block';
      window.scrollTo({top:0,behavior:'smooth'});
    };

    // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¹Ø¨Ø± GPS
    document.getElementById('getLocation').onclick = () => {
      locStatus.textContent = 'Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹...';
      if(!navigator.geolocation){
        locStatus.textContent = 'Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø®Ø¯Ù…Ø© ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹.';
        return;
      }
      navigator.geolocation.getCurrentPosition(pos => {
        const {latitude, longitude} = pos.coords;
        locationLink = `https://www.google.com/maps?q=${latitude},${longitude}`;
        locStatus.textContent = 'âœ… ØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹. Ø³ÙŠØªÙ… Ø¥Ù„Ø­Ø§Ù‚Ù‡ Ù…Ø¹ Ø§Ù„Ø·Ù„Ø¨.';
      }, err => {
        locStatus.textContent = 'ØªØ¹Ø°Ù‘Ø± ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ â€” ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„ÙˆØµÙˆÙ„.';
      }, {enableHighAccuracy:true,timeout:15000});
    };

    // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¥Ù„Ù‰ ÙˆØ§ØªØ³Ø§Ø¨
    document.getElementById('orderForm').onsubmit = (e) => {
      e.preventDefault();
      if(!whatsappNumber){
        alert('Ø±Ù‚Ù… ÙˆØ§ØªØ³Ø§Ø¨ ØºÙŠØ± Ù…ÙØ¹Ù‘Ù„ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯. ØªÙˆØ§ØµÙ„ Ù…Ø¹ÙŠ Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±Ù‚Ù….');
        return;
      }
      const name = document.getElementById('custName').value.trim();
      const phone = document.getElementById('custPhone').value.trim();
      const addr = document.getElementById('custAddress').value.trim();
      const near = document.getElementById('custNear').value.trim();

      if(!name || !phone || !addr || !near){
        alert('ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©.');
        return;
      }
      // ØªØ¬Ù…ÙŠØ¹ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨
      const productsList = cart.map(it => `- ${it.name} (x${it.qty}) â€” ${nf.format(it.price * it.qty)} Ø¯.Ø¹`).join('\n');
      const totalAmount = cart.reduce((s,i) => s + i.price * i.qty, 0);
      let message = `Ø·Ù„Ø¨ Ø­Ø¬Ø² Ø¬Ø¯ÙŠØ¯\n\nğŸ‘¤ Ø§Ù„Ø§Ø³Ù…: ${name}\nğŸ“ Ø§Ù„Ù‡Ø§ØªÙ: ${phone}\nğŸ  Ø§Ù„Ø³ÙƒÙ†: ${addr}\nğŸ“ Ø£Ù‚Ø±Ø¨ Ù†Ù‚Ø·Ø© Ø¯Ø§Ù„Ø©: ${near}\n\nğŸ§¾ Ø§Ù„Ø·Ù„Ø¨:\n${productsList}\n\nğŸ’° Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: ${nf.format(totalAmount)} Ø¯.Ø¹\n`;
      if(locationLink) message += `\nğŸ“Œ Ø§Ù„Ù…ÙˆÙ‚Ø¹: ${locationLink}\n`;
      message += `\nğŸ”” Ù…Ù„Ø§Ø­Ø¸Ø©: Ø§Ù„Ø¹Ø·ÙˆØ± Ù…ØµÙ†ÙˆØ¹Ø© Ù…Ù† Ø®Ù„Ø·Ø© Ø®Ø§ØµØ© ÙˆÙ„Ø§ ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø²ÙŠÙˆØª Ù…Ø¶Ø±Ø© Ø£Ùˆ Ù…Ø³Ø¨Ø¨Ø© Ø­Ø³Ø§Ø³ÙŠØ©.`;

      const waUrl = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message)}`;
      // ÙØªØ­ ÙˆØ§ØªØ³Ø§Ø¨ ÙÙŠ Ù†Ø§ÙØ°Ø© Ø¬Ø¯ÙŠØ¯Ø©
      window.open(waUrl, '_blank');

      // Ù…Ø³Ø­ Ø§Ù„Ø³Ù„Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ) â€” Ø³Ø£ÙØ¹Ù„Ù‡Ø§ Ø¨Ø¹Ø¯ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©
      cart = [];
      saveCart();
      checkoutPage.style.display = 'none';
      homePage.style.display = 'block';
    };

    // Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù†Øµ Ù…Ù† Ø¥Ø¯Ø®Ø§Ù„ HTML
    function escapeHtml(s){
      if(!s) return '';
      return String(s).replace(/[&<>"']/g, function(m){ return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]; });
    }

    // ØªÙ‡ÙŠØ¦Ø© Ø£ÙˆÙ„ÙŠØ©
    function init(){
      renderProducts(products);
      renderCart();
      document.getElementById('year').textContent = new Date().getFullYear();
    }

    // Ù†ÙÙ‘Ø° init
    init();
  </script>
</body>
</html>
